# .github/workflows/pr_reviewer.yml
name: Pull Request

on:
  pull_request:
    types: [review_requested]  # ë¦¬ë·°ìš”ì²­ ì‹œ íŠ¸ë¦¬ê±°

permissions:
  contents: read
  pull-requests: read

jobs:
  specific_review_requested:
    runs-on: ubuntu-latest
    steps:
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # ê°œì¸ ë¦¬ë·°ì–´ ì•Œë¦¼
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: pr reviewer ë˜ë©´ slack ì•Œë¦¼ ë³´ëƒ„ (ê°œì¸)
        if: >
          ${{
            github.event.action == 'review_requested' &&
            github.event.requested_reviewer != null &&
            github.event.pull_request.draft == false
          }}
        uses: slackapi/slack-github-action@v1.24.0
        with:
          channel-id: ${{ secrets.TEST_CHANNEL }}   # Cë¡œ ì‹œì‘í•˜ëŠ” ì±„ë„ ID
          payload: |
            {
              "text": "pr review request",
              "blocks": [
                { "type": "header", "text": { "type": "plain_text", "text": "ğŸ‘€ ë¦¬ë·° ìš”ì²­ (ê°œì¸)" } },
                {
                  "type": "section",
                  "fields": [
                    { "type": "mrkdwn", "text": "*ì œëª©*\n${{ github.event.pull_request.title }}" },
                    { "type": "mrkdwn", "text": "*ë ˆí¬*\n${{ github.repository }}" },
                    { "type": "mrkdwn", "text": "*ì‘ì„±ì*\n@${{ github.event.pull_request.user.login }}" },
                    { "type": "mrkdwn", "text": "*ë¦¬ë·°ì–´*\n@${{ github.event.requested_reviewer.login }}" }
                  ]
                },
                {
                  "type": "actions",
                  "elements": [
                    { "type": "button", "text": { "type": "plain_text", "text": "PR ì—´ê¸°" }, "url": "${{ github.event.pull_request.html_url }}" }
                  ]
                }
              ]
            }
        env:
          SLACK_BOT_TOKEN: ${{ secrets.TEST_BOT_TOKEN }}  # xoxb-... í† í°

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # íŒ€ ë¦¬ë·°ì–´ ì•Œë¦¼
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: pr reviewer ë˜ë©´ slack ì•Œë¦¼ ë³´ëƒ„ (íŒ€)
        if: >
          ${{
            github.event.action == 'review_requested' &&
            github.event.requested_team != null &&
            github.event.pull_request.draft == false
          }}
        uses: slackapi/slack-github-action@v1.24.0
        with:
          channel-id: ${{ secrets.TEST_CHANNEL }}   # íŒ€ìš© ì±„ë„ ë³„ë„ë©´ ë‹¤ë¥¸ Secret ì‚¬ìš©
          payload: |
            {
              "text": "pr review request (team)",
              "blocks": [
                { "type": "header", "text": { "type": "plain_text", "text": "ğŸ‘¥ ë¦¬ë·° ìš”ì²­ (íŒ€)" } },
                {
                  "type": "section",
                  "fields": [
                    { "type": "mrkdwn", "text": "*ì œëª©*\n${{ github.event.pull_request.title }}" },
                    { "type": "mrkdwn", "text": "*ë ˆí¬*\n${{ github.repository }}" },
                    { "type": "mrkdwn", "text": "*ì‘ì„±ì*\n@${{ github.event.pull_request.user.login }}" },
                    { "type": "mrkdwn", "text": "*íŒ€*\n#${{ github.event.requested_team.slug }}" }
                  ]
                },
                {
                  "type": "actions",
                  "elements": [
                    { "type": "button", "text": { "type": "plain_text", "text": "PR ì—´ê¸°" }, "url": "${{ github.event.pull_request.html_url }}" }
                  ]
                }
              ]
            }
        env:
          SLACK_BOT_TOKEN: ${{ secrets.TEST_BOT_TOKEN }}  # xoxb-... í† í°
